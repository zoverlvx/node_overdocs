{"version":3,"sources":["../src/router.js"],"names":["express","require","app","router","Router","mongoose","Libraries","_","bodyParser","jsonParser","json","use","get","req","res","console","log","body","find","err","library_name","status","message","findOne","params","method","description","post","create","library","put","findOneAndUpdate","$push","entries","delete","findOneAndRemove","send","module","exports"],"mappings":"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","file":"router.js","sourcesContent":["'use strict';\n\nconst express = require(\"express\");\nconst app = express();\nconst router = express.Router();\nconst mongoose = require('mongoose');\nconst Libraries = require('../models/library');\nconst _ = require('underscore');\nconst bodyParser = require('body-parser');\nconst jsonParser = bodyParser.json();\n\napp.use(jsonParser);\n\n\n//GET all libraries\nrouter.get('/libraries', (req, res) => {\n    console.log(req.body);\n\n    Libraries.find((err, library_name) => {\n        if (err) {\n            return res.status(500).json({\n                message: 'Internal Server Error'\n            });\n        }\n        res.json(library_name);\n    });\n});\n\n//GET library\nrouter.get('/libraries/:library_name/', (req, res) => {\n    console.log('Here is GET');\n    Libraries.findOne({\n        library_name: req.params.library_name\n    }), (err, method) => {\n        if (typeof library_name === 'undefined') {\n            return res.status(404).json({\n                status: 'error'\n            });\n        }\n        else if (err) {\n            return res.status(500).json({\n                message: 'Library not found.'\n            });\n        }\n        console.log('Here is GET/libraries');\n        res.json(method);\n    }\n});\n\n//GET method\nrouter.get('/libraries/:library_name/:method/', (req, res) => {\n    console.log('Getting methods');\n    console.log(req.params);\n    Libraries.findOne({\n        method: req.params.method\n    }), (err, description) => {\n\n        if (typeof method === 'undefined') {\n            return res.status(404).json({\n                status: 'error'\n            });\n        }\n        else if (err) {\n            return res.status(500).json({\n                message: 'Method not found.'\n            });\n        }\n        res.json(description);\n    }\n});\n\n//POST libraries\nrouter.post('/libraries', (req, res) => {\n    console.log(req.body);\n    console.log('This is params', req.params);\n    Libraries.create({\n        library_name: req.body.library_name\n    }, (err, library) => {\n\n        if (typeof library_name === 'undefined') {\n            return res.status(412).json({\n                status: 'Precondition wasn\\'t met'\n            });\n        }\n        else if (err) {\n            return res.status(500).json({\n                message: 'Internal Server Error'\n            });\n        }\n        res.status(201).json(library);\n    });\n});\n\n//PUT method and description to library\nrouter.put('/libraries/:library_name', (req, res) => {\n    console.log(req.body);\n    Libraries.findOneAndUpdate({\n        library_name: req.params.library_name,\n    }, {\n        $push: {\n            entries: [{\n                method: req.body.method,\n                description: req.body.description\n            }]\n        }\n    }, (err, library) => {\n\n        if (typeof method === 'undefined' || typeof description === 'undefined') {\n            res.status(404).json({\n                status: 'error'\n            });\n        }\n        else if (err) {\n            console.log(err)\n        }\n        console.log(library);\n    });\n});\n\n// router.put('/libraries/:library_name/:method', (req, res) => { \n//     let method = req.body.entries[0].method;\n//     Libraries.findOne({\n//         method: method\n//     }, (err, updatedMethod) => {\n\n//         if (typeof method === 'undefined') {\n//             res.status(404).json({\n//                 status: 'error'\n//             });\n//         }\n//         else if (err) {\n//             res.status(500).send(err);\n//         }\n//         else if (req.body.entries[0].method) {\n//             updatedMethod.method = req.body.entries[0].method;\n//             res.status(200).send(updatedMethod);\n\n//         }\n//     });\n// });\n\n// router.put('/libraries/:library_name/:method/:description', (req, res) => {\n//     let description = req.body.entries[0].description // still, no idea why this is doing this   \n//     Libraries.findOne({\n//         description: description\n//     }, (err, updatedDescription) => {\n//         if (err) {\n//             res.status(500).send(err);\n//         }\n//         else if (req.body.entries[0].description) {\n//             updatedDescription.description = req.body.entries[0].description;\n//             res.status(200).send(updatedDescription);\n//         }\n//     });\n// });\n\n\n//DELETE library and methods //needs more info\nrouter.delete('/libraries/:library_name', (req, res) => {\n    let library_name = req.params.library_name; //body isn't working either\n    console.log(req.params.library_name);\n    Libraries.findOneAndRemove({\n        library_name: library_name\n        //doesn't delete the associated methods and descriptions\n    }, (err, library) => {\n        if (err) {\n            console.log(err);\n            res.status(500).send();\n        }\n        console.log(library);\n        res.status(200).send();\n    });\n});\n\n//DELETE method and description // Can't tell if this is completely working because I can't GET methods to DOM\nrouter.delete('/libraries/:library_name/:method', (req, res) => {\n    let method = req.body.method;\n    Libraries.findOneAndRemove({\n        method: method\n        // and description\n    }, (err) => {\n        if (err) {\n            console.log(err);\n            res.status(500).send();\n        }\n\n        res.status(200).send();\n    });\n});\n\nmodule.exports = router;\n"]}